"use strict";(self.webpackChunkngdemos=self.webpackChunkngdemos||[]).push([[2312],{6813:(W,I,l)=>{l.d(I,{D:()=>L});var P=l(5548),k=l(5894),n=l(8053),N=l(7879),F=l(3534);function L(...h){if(1===h.length){const g=h[0];if((0,k.k)(g))return S(g,null);if((0,N.K)(g)&&Object.getPrototypeOf(g)===Object.prototype){const m=Object.keys(g);return S(m.map(M=>g[M]),m)}}if("function"==typeof h[h.length-1]){const g=h.pop();return S(h=1===h.length&&(0,k.k)(h[0])?h[0]:h,null).pipe((0,n.U)(m=>g(...m)))}return S(h,null)}function S(h,g){return new P.y(m=>{const M=h.length;if(0===M)return void m.complete();const A=new Array(M);let R=0,p=0;for(let d=0;d<M;d++){const c=(0,F.D)(h[d]);let f=!1;m.add(c.subscribe({next:_=>{f||(f=!0,p++),A[d]=_},error:_=>m.error(_),complete:()=>{R++,(R===M||!f)&&(p===M&&m.next(g?g.reduce((_,T,v)=>(_[T]=A[v],_),{}):A),m.complete())}}))}})}},7214:(W,I,l)=>{l.d(I,{b:()=>k});var P=l(5548);function k(n){return!!n&&(n instanceof P.y||"function"==typeof n.lift&&"function"==typeof n.subscribe)}},3170:(W,I,l)=>{l.r(I),l.d(I,{TreeModule:()=>ke});var P=l(6019),k=l(9843),n=l(3668),N=l(581),F=l(8053),L=l(6636);let S=(()=>{class t extends N.c8{constructor(e){super("DataSource",e)}addOne(e){this.addOneToCache(e)}addMany(e){this.addManyToCache(e)}updateOne(e){this.updateOneInCache(e)}updateMany(e){this.updateManyInCache(e)}removeOne(e){this.removeOneFromCache(e)}removeMany(e){this.removeManyFromCache(e)}upsertOne(e){this.upsertOneInCache(e)}getAll(){return this.selectors$.entities$}getOne(e){const r="string"==typeof e?e:e.id;return this.selectors$.entities$.pipe((0,F.U)(s=>s.filter(o=>o.id===r)[0]),(0,L.q)(1))}patchOne(e,r){const s={children:[...e.children,r]},o=Object.assign(Object.assign({},e),s);this.upsertOne(o)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(N.yV))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();const h=t=>!!t&&"[object Object]"===Object.prototype.toString.call(t),g=t=>h(t)&&0===Object.keys(t).length,m=(t,i)=>typeof t==typeof i&&(Array.isArray(t)&&Array.isArray(i)?t.every((e,r)=>m(t[r],i[r])):h(t)&&h(i)?Object.keys(i).every(e=>Object.prototype.hasOwnProperty.call(t,e)&&m(t[e],i[e])):t===i);function A(t,i,e){if(void 0===t)return;const r=s=>{if(!h(s))return s;let o=Object.assign({},s);return m(o,i)&&(o=Object.assign({},e)),Object.keys(o).forEach(a=>{(h(o[a])||Array.isArray(o[a]))&&(o=Object.assign(Object.assign({},o),{[a]:A(o[a],i,e)}))}),o};return!Array.isArray(t)&&!h(t)||g(i)||g(e)?t:Array.isArray(t)?t.map(s=>r(s)):r(t)}function R(t,i,e){if(void 0===t)return;const r=s=>{if(!h(s))return s;let o=Object.assign({},s);return m(o,i)&&Object.keys(e).forEach(a=>{Object.prototype.hasOwnProperty.call(o,a)&&(o=Object.assign(Object.assign({},o),{[a]:e[a]}))}),Object.keys(o).forEach(a=>{(h(o[a])||Array.isArray(o[a]))&&(o=Object.assign(Object.assign({},o),{[a]:R(o[a],i,e)}))}),o};return!Array.isArray(t)&&!h(t)||g(i)||g(e)?t:Array.isArray(t)?t.map(s=>r(s)):r(t)}function p(t,i){if(void 0===t)return;const e=r=>{if(!h(r))return r;let s=Object.assign({},r);return Object.keys(s).forEach(o=>{(h(s[o])||Array.isArray(s[o]))&&(s=Object.assign(Object.assign({},s),{[o]:p(s[o],i)}))}),s};return!Array.isArray(t)&&!h(t)||g(i)?t:Array.isArray(t)?t.filter(r=>!m(r,i)).map(r=>e(r)):m(t,i)?void 0:e(t)}function v(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))return function(t,i){const e=Object.keys(t),r=new Array(e.length);for(const s of e){const o=t[s];r[s]="object"!=typeof o||null===o?o:i(o)}return r}(t,v);const i={};for(const e in t){if(!1===Object.hasOwnProperty.call(t,e))continue;const r=t[e];i[e]="object"!=typeof r||null===r?r:v(r)}return i}let O=(()=>{class t{constructor(e){this.dataSourceService=e,this.expandedNodes=new Set,this.flatNodeMap=new Map}toggleExpandedNodes(e,r,s=!1){let o=r.id||r.name;s?this.expandedNodes.delete(o):this.expandedNodes.add(o)}restoreExpandedNodes(e){this.expandedNodes.forEach(r=>{const s=e.dataNodes.find(o=>(o.id||o.name)===r);e.expand(s)})}getParent(e){const{treeControl:r}=this;if(r.getLevel(e)<1)return null;for(let a=r.dataNodes.indexOf(e)-1;a>=0;a--){const u=r.dataNodes[a];if(0===r.getLevel(u))return u}}updateNode(e,r){const s=this.getParent(e),o=this.flatNodeMap.get(s);this.dataSourceService.getOne(o.id).subscribe(a=>{const u=R(a,{name:e.name},r);this.dataSourceService.updateOne(u)})}addNodeToParent(e,r){e.children=[...e.children,r],this.dataSourceService.updateOne(e)}addNode(e,r){if(e.level){const s=this.flatNodeMap.get(e),o=this.getParent(e),a=this.flatNodeMap.get(o);this.dataSourceService.getOne(a.id).subscribe(u=>{const C=Object.assign(Object.assign({},s),{children:[...s.children,r]}),b=A(u,{name:e.name},C);this.dataSourceService.updateOne(b)})}else{const o=v(this.flatNodeMap.get(e));this.addNodeToParent(o,r)}}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(S))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();var E=l(5351),y=l(3405),D=l(4099),w=l(7214),oe=l(2411),U=l(8805),B=l(348),ae=l(8290);class ce extends class{constructor(){this.expansionModel=new E.Ov(!0)}toggle(i){this.expansionModel.toggle(this._trackByValue(i))}expand(i){this.expansionModel.select(this._trackByValue(i))}collapse(i){this.expansionModel.deselect(this._trackByValue(i))}isExpanded(i){return this.expansionModel.isSelected(this._trackByValue(i))}toggleDescendants(i){this.expansionModel.isSelected(this._trackByValue(i))?this.collapseDescendants(i):this.expandDescendants(i)}collapseAll(){this.expansionModel.clear()}expandDescendants(i){let e=[i];e.push(...this.getDescendants(i)),this.expansionModel.select(...e.map(r=>this._trackByValue(r)))}collapseDescendants(i){let e=[i];e.push(...this.getDescendants(i)),this.expansionModel.deselect(...e.map(r=>this._trackByValue(r)))}_trackByValue(i){return this.trackBy?this.trackBy(i):i}}{constructor(i,e,r){super(),this.getLevel=i,this.isExpandable=e,this.options=r,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(i){const r=[];for(let s=this.dataNodes.indexOf(i)+1;s<this.dataNodes.length&&this.getLevel(i)<this.getLevel(this.dataNodes[s]);s++)r.push(this.dataNodes[s]);return r}expandAll(){this.expansionModel.select(...this.dataNodes.map(i=>this._trackByValue(i)))}}const H=new n.InjectionToken("CDK_TREE_NODE_OUTLET_NODE");let V=(()=>{class t{constructor(e,r){this.viewContainer=e,this._node=r}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ViewContainerRef),n.\u0275\u0275directiveInject(H,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeOutlet",""]]}),t})();class le{constructor(i){this.$implicit=i}}let Q=(()=>{class t{constructor(e){this.template=e}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.TemplateRef))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),j=(()=>{class t{constructor(e,r){this._differs=e,this._changeDetectorRef=r,this._onDestroy=new y.xQ,this._levels=new Map,this.viewChange=new D.X({start:0,end:Number.MAX_VALUE})}get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const e=this._nodeDefs.filter(r=>!r.when);this._defaultNodeDef=e[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(e){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let e;(0,E.Z9)(this._dataSource)?e=this._dataSource.connect(this):(0,w.b)(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=(0,oe.of)(this._dataSource)),e&&(this._dataSubscription=e.pipe((0,U.R)(this._onDestroy)).subscribe(r=>this.renderNodeChanges(r)))}renderNodeChanges(e,r=this._dataDiffer,s=this._nodeOutlet.viewContainer,o){const a=r.diff(e);!a||(a.forEachOperation((u,C,b)=>{if(null==u.previousIndex)this.insertNode(e[b],b,s,o);else if(null==b)s.remove(C),this._levels.delete(u.item);else{const Y=s.get(C);s.move(Y,b)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(e,r){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(o=>o.when&&o.when(r,e))||this._defaultNodeDef}insertNode(e,r,s,o){const a=this._getNodeDef(e,r),u=new le(e);u.level=this.treeControl.getLevel?this.treeControl.getLevel(e):void 0!==o&&this._levels.has(o)?this._levels.get(o)+1:0,this._levels.set(e,u.level),(s||this._nodeOutlet.viewContainer).createEmbeddedView(a.template,u,r),x.mostRecentTreeNode&&(x.mostRecentTreeNode.data=e)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.IterableDiffers),n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["cdk-tree"]],contentQueries:function(e,r,s){if(1&e&&n.\u0275\u0275contentQuery(s,Q,5),2&e){let o;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r._nodeDefs=o)}},viewQuery:function(e,r){if(1&e&&n.\u0275\u0275viewQuery(V,7),2&e){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(r._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(e,r){1&e&&n.\u0275\u0275elementContainer(0,0)},directives:[V],encapsulation:2}),t})(),x=(()=>{class t{constructor(e,r){this._elementRef=e,this._tree=r,this._destroyed=new y.xQ,this._dataChanges=new y.xQ,t.mostRecentTreeNode=this,this._elementRef.nativeElement.classList.add("cdk-tree-node"),this.role="treeitem"}get role(){return"treeitem"}set role(e){this._elementRef.nativeElement.setAttribute("role",e)}get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}_setExpanded(e){this._isAriaExpanded=e,this._elementRef.nativeElement.setAttribute("aria-expanded",`${e}`)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):this._parentNodeAriaLevel}ngOnInit(){this._parentNodeAriaLevel=function(t){let i=t.parentElement;for(;i&&!he(i);)i=i.parentElement;return i?i.classList.contains("cdk-nested-tree-node")?(0,B.su)(i.getAttribute("aria-level")):0:-1}(this._elementRef.nativeElement),this._elementRef.nativeElement.setAttribute("aria-level",`${this.level+1}`)}ngDoCheck(){this.isExpanded!=this._isAriaExpanded&&this._setExpanded(this.isExpanded)}ngOnDestroy(){t.mostRecentTreeNode===this&&(t.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return t.mostRecentTreeNode=null,t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(j))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["cdk-tree-node"]],inputs:{role:"role"},exportAs:["cdkTreeNode"]}),t})();function he(t){const i=t.classList;return!(!(null==i?void 0:i.contains("cdk-nested-tree-node"))&&!(null==i?void 0:i.contains("cdk-tree")))}const fe=/([A-Za-z%]+)$/;let X=(()=>{class t{constructor(e,r,s,o){this._treeNode=e,this._tree=r,this._element=s,this._dir=o,this._destroyed=new y.xQ,this.indentUnits="px",this._indent=40,this._setPadding(),o&&o.change.pipe((0,U.R)(this._destroyed)).subscribe(()=>this._setPadding(!0)),e._dataChanges.subscribe(()=>this._setPadding())}get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){const e=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,r=null==this._level?e:this._level;return"number"==typeof r?`${r*this._indent}${this.indentUnits}`:null}_setPadding(e=!1){const r=this._paddingIndent();if(r!==this._currentPadding||e){const s=this._element.nativeElement,o=this._dir&&"rtl"===this._dir.value?"paddingRight":"paddingLeft",a="paddingLeft"===o?"paddingRight":"paddingLeft";s.style[o]=r||"",s.style[a]="",this._currentPadding=r}}_setLevelInput(e){this._level=(0,B.su)(e,null),this._setPadding()}_setIndentInput(e){let r=e,s="px";if("string"==typeof e){const o=e.split(fe);r=o[0],s=o[1]||s}this.indentUnits=s,this._indent=(0,B.su)(r),this._setPadding()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(x),n.\u0275\u0275directiveInject(j),n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(ae.Is,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:["cdkTreeNodePadding","level"],indent:["cdkTreeNodePaddingIndent","indent"]}}),t})(),G=(()=>{class t{constructor(e,r){this._tree=e,this._treeNode=r,this._recursive=!1}get recursive(){return this._recursive}set recursive(e){this._recursive=(0,B.Ig)(e)}_toggle(e){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),e.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(j),n.\u0275\u0275directiveInject(x))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(e,r){1&e&&n.\u0275\u0275listener("click",function(o){return r._toggle(o)})},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),t})(),pe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({}),t})();var $=l(6731),ge=l(8526);const me=(0,$.sb)((0,$.Id)(x));let Z=(()=>{class t extends me{constructor(e,r,s){super(e,r),this.tabIndex=Number(s)||0,e.nativeElement.classList.add("mat-tree-node")}ngOnInit(){super.ngOnInit()}ngDoCheck(){super.ngDoCheck()}ngOnDestroy(){super.ngOnDestroy()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(j),n.\u0275\u0275injectAttribute("tabindex"))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["mat-tree-node"]],inputs:{role:"role",disabled:"disabled",tabIndex:"tabIndex"},exportAs:["matTreeNode"],features:[n.\u0275\u0275ProvidersFeature([{provide:x,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),q=(()=>{class t extends Q{}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[n.\u0275\u0275ProvidersFeature([{provide:Q,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),ee=(()=>{class t extends X{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodePadding",""]],inputs:{level:["matTreeNodePadding","level"],indent:["matTreeNodePaddingIndent","indent"]},features:[n.\u0275\u0275ProvidersFeature([{provide:X,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),J=(()=>{class t{constructor(e,r){this.viewContainer=e,this._node=r}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ViewContainerRef),n.\u0275\u0275directiveInject(H,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeOutlet",""]],features:[n.\u0275\u0275ProvidersFeature([{provide:V,useExisting:t}])]}),t})(),te=(()=>{class t extends j{}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["mat-tree"]],viewQuery:function(e,r){if(1&e&&n.\u0275\u0275viewQuery(J,7),2&e){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(r._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"mat-tree","cdk-tree"],exportAs:["matTree"],features:[n.\u0275\u0275ProvidersFeature([{provide:j,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(e,r){1&e&&n.\u0275\u0275elementContainer(0,0)},directives:[J],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}\n"],encapsulation:2}),t})(),ne=(()=>{class t extends G{get recursive(){return this._recursive}set recursive(e){this._recursive=(0,B.Ig)(e)}}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[n.\u0275\u0275ProvidersFeature([{provide:G,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),ve=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({imports:[[pe,$.BQ],$.BQ]}),t})();class ye{constructor(i,e,r,s){this.transformFunction=i,this.getLevel=e,this.isExpandable=r,this.getChildren=s}_flattenNode(i,e,r,s){const o=this.transformFunction(i,e);if(r.push(o),this.isExpandable(o)){const a=this.getChildren(i);a&&(Array.isArray(a)?this._flattenChildren(a,e,r,s):a.pipe((0,L.q)(1)).subscribe(u=>{this._flattenChildren(u,e,r,s)}))}return r}_flattenChildren(i,e,r,s){i.forEach((o,a)=>{let u=s.slice();u.push(a!=i.length-1),this._flattenNode(o,e+1,r,u)})}flattenNodes(i){let e=[];return i.forEach(r=>this._flattenNode(r,0,e,[])),e}expandFlattenedNodes(i,e){let r=[],s=[];return s[0]=!0,i.forEach(o=>{let a=!0;for(let u=0;u<=this.getLevel(o);u++)a=a&&s[u];a&&r.push(o),this.isExpandable(o)&&(s[this.getLevel(o)+1]=e.isExpanded(o))}),r}}class Te extends E.o2{constructor(i,e,r){super(),this._treeControl=i,this._treeFlattener=e,this._flattenedData=new D.X([]),this._expandedData=new D.X([]),this._data=new D.X([]),r&&(this.data=r)}get data(){return this._data.value}set data(i){this._data.next(i),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}connect(i){return(0,ge.T)(i.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,F.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}const De=[{id:"componentsID",name:"components",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"angularID",name:"angular",type:"folder",children:[{name:"packages",type:"folder",children:[{name:".travis.yml",type:"file"},{name:"firebase.json",type:"file"},{name:"firebase1.json",type:"file",work:"None"},{name:"firebase2.json",type:"file"}]},{name:"package.json",type:"file"}]},{id:"angularjsID",name:"angularjs",type:"folder",children:[{name:"gulpfile.js",type:"file"},{name:"README.md",type:"file"}]}];var z=l(86),re=l(9112);function Ce(t,i){if(1&t){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-tree-node",3),n.\u0275\u0275element(1,"button",4),n.\u0275\u0275element(2,"i",5),n.\u0275\u0275text(3),n.\u0275\u0275elementStart(4,"button",6),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit;return n.\u0275\u0275nextContext().editNode(o)}),n.\u0275\u0275element(5,"i",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"button",8),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit;return n.\u0275\u0275nextContext().deleteNode(o)}),n.\u0275\u0275element(7,"i",9),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd()}if(2&t){const e=i.$implicit;n.\u0275\u0275advance(2),n.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),n.\u0275\u0275attribute("aria-label",e.type+"icon"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",e.name," ")}}function be(t,i){if(1&t){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-tree-node",10),n.\u0275\u0275elementStart(1,"button",11),n.\u0275\u0275element(2,"i",12),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"mat-icon"),n.\u0275\u0275text(4),n.\u0275\u0275elementStart(5,"button",13),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit;return n.\u0275\u0275nextContext().addNode(o)}),n.\u0275\u0275element(6,"i",14),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd()}if(2&t){const e=i.$implicit,r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275attribute("aria-label","Toggle "+e.name),n.\u0275\u0275advance(1),n.\u0275\u0275classProp("ti-angle-down",r.expandedElement!==r.element)("ti-angle-right",r.expandedElement===r.element),n.\u0275\u0275advance(1),n.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),n.\u0275\u0275attribute("aria-label",e.type+"icon"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",e.name," ")}}let Ee=(()=>{class t{constructor(e,r){this.dataSourceService=e,this.dsHelperService=r,this.editNodeChange=new n.EventEmitter,this.addNodeChange=new n.EventEmitter,this.activeNode=null,this.transformer=(s,o)=>{const a=Object.assign(Object.assign({},s.id&&{id:s.id}),{name:s.name,type:s.type,level:o,expandable:!!s.children});return this.dsHelperService.flatNodeMap.set(a,s),a},this.treeFlattener=new ye(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new ce(this.getLevel,this.isExpandable),this.dataSource=new Te(this.treeControl,this.treeFlattener),this.dsHelperService.treeFlattener=this.treeFlattener,this.dsHelperService.treeControl=this.treeControl}ngOnInit(){this.initializeData(),this.handleExpandedNodes()}editNode(e){this.editNodeChange.emit(e)}initializeData(){this.dataSourceService.addManyToCache(De),this.dataSources$=this.dataSourceService.entities$,this.dataSources$.subscribe(e=>{this.dataSource.data=e,this.dsHelperService.restoreExpandedNodes(this.treeControl)})}getLevel(e){return e.level}isExpandable(e){return e.expandable}hasChild(e,r){return r.expandable}getChildren(e){return e.children}handleExpandedNodes(){this.treeControl.expansionModel.changed.subscribe(e=>{e.added[0]&&e.added.length?this.dsHelperService.toggleExpandedNodes(this.treeControl,e.added[0]):e.removed.length&&e.removed.forEach(r=>{this.dsHelperService.toggleExpandedNodes(this.treeControl,r,!0)})})}deleteNode(e){const r=this.dsHelperService.getParent(e),s=this.dsHelperService.flatNodeMap.get(r);this.dataSourceService.getOne(s.id).subscribe(o=>{const a=p(o,{name:e.name});this.dataSourceService.updateOne(a)})}addNode(e){this.addNodeChange.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(S),n.\u0275\u0275directiveInject(O))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["lib-data-source-list"]],outputs:{editNodeChange:"editNodeChange",addNodeChange:"addNodeChange"},decls:3,vars:3,consts:[[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"type-icon"],["mat-icon-button","","color","accent",1,"icon-btn","edit",3,"click"],[1,"ti-pencil"],["mat-icon-button","","color","warn",1,"icon-btn","delete",3,"click"],[1,"ti-trash"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["mat-icon-button","","color","accent",3,"click"],[1,"ti-plus"]],template:function(e,r){1&e&&(n.\u0275\u0275elementStart(0,"mat-tree",0),n.\u0275\u0275template(1,Ce,8,6,"mat-tree-node",1),n.\u0275\u0275template(2,be,7,11,"mat-tree-node",2),n.\u0275\u0275elementEnd()),2&e&&(n.\u0275\u0275property("dataSource",r.dataSource)("treeControl",r.treeControl),n.\u0275\u0275advance(2),n.\u0275\u0275property("matTreeNodeDefWhen",r.hasChild))},directives:[te,q,Z,ne,ee,z.lW,re.Hw],styles:[".type-icon[_ngcontent-%COMP%]{color:#757575;margin-right:5px}.icon-btn[_ngcontent-%COMP%]{margin-left:10px}.edit[_ngcontent-%COMP%]     .mat-icon, .delete[_ngcontent-%COMP%]     .mat-icon{font-size:18px}.ti-folder[_ngcontent-%COMP%]{margin-top:8px}"]}),t})();var Ne=l(4522);let ie=(()=>{class t extends N.EJ{constructor(e,r){super("DataSource",e,r)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(Ne.eN),n.\u0275\u0275inject(N.hR))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();const Se={DataSource:{selectId(t){if(null!==t)return t.id||t.name?`${t.id||t.name}`:t._id},entityDispatcherOptions:{optimisticUpdate:!0}}};let Oe=(()=>{class t{constructor(e,r,s){this.eds=e,this.entityDataService=r,this.dataSourceService=s,this.eds.registerMetadataMap(Se),this.entityDataService.registerService("DataSource",this.dataSourceService)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(N.f0),n.\u0275\u0275inject(N.sP),n.\u0275\u0275inject(ie))},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({providers:[ie,S,O],imports:[[ve,re.Ps,z.ot]]}),t})();const Me=[{path:"",component:(()=>{class t{constructor(e,r){this.dataSourceService=e,this.dsHelperService=r}ngOnInit(){}addOne(){this.dataSourceService.addOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}addMany(){this.dataSourceService.addMany([{id:"TESTIDMANY",name:"Test add many",type:"folder",children:[{name:"src many",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsIDMANY",name:"components many 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}upsertOne(){this.dataSourceService.upsertOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}removeOne(){this.dataSourceService.removeOne("TESTID")}removeMany(){this.dataSourceService.removeMany(["TESTID","componentsID"])}updateOne(){this.dataSourceService.updateOne({id:"TESTID",name:"Test 1",type:"folder",children:[{name:"src 1",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}updateMany(){this.dataSourceService.updateMany([{id:"TESTID",name:"Test 2",type:"folder",children:[{name:"src 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsID",name:"components 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}getOne(){this.dataSourceService.getOne("TESTID").subscribe(console.log)}patchOne(){this.dataSourceService.patchOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"TESTIDWOrker",name:"Worker",type:"folder",children:[{id:"TESTIDWOrker2",name:"Worker 2",type:"file"}]})}getFlattenNodes(){console.log("HERREE ",this.dsHelperService.treeFlattener),console.log("Flatten nodes with treeControl ",this.dsHelperService.treeControl.dataNodes),this.dataSourceService.getAll().subscribe(e=>{console.log("Node matrix ",e),console.log("Flatten Nodes ",this.dsHelperService.treeFlattener.flattenNodes(e))})}onNodeEdit(e){const r=this.dsHelperService.flatNodeMap.get(e);this.dsHelperService.updateNode(e,Object.assign(Object.assign({},r),{name:r.name+" UPDATED!"}))}onNodeAdd(e){this.dsHelperService.flatNodeMap.get(e),this.dsHelperService.addNode(e,{id:"addNodeID",name:"My New node",type:"file"})}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(S),n.\u0275\u0275directiveInject(O))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["app-tree"]],decls:27,vars:0,consts:[[1,"container"],[1,"col"],[3,"editNodeChange","addNodeChange"],[1,"col","action"],["mat-button","","mat-raised-button","","color","primary",3,"click"]],template:function(e,r){1&e&&(n.\u0275\u0275elementStart(0,"header"),n.\u0275\u0275elementStart(1,"h1"),n.\u0275\u0275text(2,"Tree Demo"),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(3,"div",0),n.\u0275\u0275elementStart(4,"div",1),n.\u0275\u0275elementStart(5,"lib-data-source-list",2),n.\u0275\u0275listener("editNodeChange",function(o){return r.onNodeEdit(o)})("addNodeChange",function(o){return r.onNodeAdd(o)}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",3),n.\u0275\u0275elementStart(7,"button",4),n.\u0275\u0275listener("click",function(){return r.addOne()}),n.\u0275\u0275text(8," Add DS "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(9,"button",4),n.\u0275\u0275listener("click",function(){return r.addMany()}),n.\u0275\u0275text(10," Add Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(11,"button",4),n.\u0275\u0275listener("click",function(){return r.upsertOne()}),n.\u0275\u0275text(12," Upsert One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(13,"button",4),n.\u0275\u0275listener("click",function(){return r.removeOne()}),n.\u0275\u0275text(14," Remove One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(15,"button",4),n.\u0275\u0275listener("click",function(){return r.removeMany()}),n.\u0275\u0275text(16," Remove Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(17,"button",4),n.\u0275\u0275listener("click",function(){return r.updateOne()}),n.\u0275\u0275text(18," Update One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(19,"button",4),n.\u0275\u0275listener("click",function(){return r.updateMany()}),n.\u0275\u0275text(20," Update Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(21,"button",4),n.\u0275\u0275listener("click",function(){return r.getOne()}),n.\u0275\u0275text(22," Get One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(23,"button",4),n.\u0275\u0275listener("click",function(){return r.patchOne()}),n.\u0275\u0275text(24," Patch One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(25,"button",4),n.\u0275\u0275listener("click",function(){return r.getFlattenNodes()}),n.\u0275\u0275text(26," Get Flatten Nodes "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementEnd())},directives:[Ee,z.lW],styles:["header[_ngcontent-%COMP%]{margin:20px}.container[_ngcontent-%COMP%]{grid-gap:20px;margin:20px;display:grid;grid-template-columns:3fr 1fr}.action[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:4px}"]}),t})()}];let xe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({imports:[[k.Bz.forChild(Me)],k.Bz]}),t})(),ke=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({providers:[],imports:[[P.ez,xe,z.ot,Oe]]}),t})()},5351:(W,I,l)=>{l.d(I,{P3:()=>S,o2:()=>F,Ov:()=>m,A8:()=>A,yy:()=>h,eX:()=>g,k:()=>R,Z9:()=>L});var P=l(7214),k=l(2411),n=l(3405),N=l(3668);class F{}function L(p){return p&&"function"==typeof p.connect}class S extends F{constructor(d){super(),this._data=d}connect(){return(0,P.b)(this._data)?this._data:(0,k.of)(this._data)}disconnect(){}}class h{applyChanges(d,c,f,_,T){d.forEachOperation((v,O,E)=>{let y,D;if(null==v.previousIndex){const w=f(v,O,E);y=c.createEmbeddedView(w.templateRef,w.context,w.index),D=1}else null==E?(c.remove(O),D=3):(y=c.get(O),c.move(y,E),D=2);T&&T({context:null==y?void 0:y.context,operation:D,record:v})})}detach(){}}class g{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(d,c,f,_,T){d.forEachOperation((v,O,E)=>{let y,D;null==v.previousIndex?(y=this._insertView(()=>f(v,O,E),E,c,_(v)),D=y?1:0):null==E?(this._detachAndCacheView(O,c),D=3):(y=this._moveView(O,E,c,_(v)),D=2),T&&T({context:null==y?void 0:y.context,operation:D,record:v})})}detach(){for(const d of this._viewCache)d.destroy();this._viewCache=[]}_insertView(d,c,f,_){const T=this._insertViewFromCache(c,f);if(T)return void(T.context.$implicit=_);const v=d();return f.createEmbeddedView(v.templateRef,v.context,v.index)}_detachAndCacheView(d,c){const f=c.detach(d);this._maybeCacheView(f,c)}_moveView(d,c,f,_){const T=f.get(d);return f.move(T,c),T.context.$implicit=_,T}_maybeCacheView(d,c){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(d);else{const f=c.indexOf(d);-1===f?d.destroy():c.remove(f)}}_insertViewFromCache(d,c){const f=this._viewCache.pop();return f&&c.insert(f,d),f||null}}class m{constructor(d=!1,c,f=!0){this._multiple=d,this._emitChanges=f,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new n.xQ,c&&c.length&&(d?c.forEach(_=>this._markSelected(_)):this._markSelected(c[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...d){this._verifyValueAssignment(d),d.forEach(c=>this._markSelected(c)),this._emitChangeEvent()}deselect(...d){this._verifyValueAssignment(d),d.forEach(c=>this._unmarkSelected(c)),this._emitChangeEvent()}toggle(d){this.isSelected(d)?this.deselect(d):this.select(d)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(d){return this._selection.has(d)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(d){this._multiple&&this.selected&&this._selected.sort(d)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(d){this.isSelected(d)||(this._multiple||this._unmarkAll(),this._selection.add(d),this._emitChanges&&this._selectedToEmit.push(d))}_unmarkSelected(d){this.isSelected(d)&&(this._selection.delete(d),this._emitChanges&&this._deselectedToEmit.push(d))}_unmarkAll(){this.isEmpty()||this._selection.forEach(d=>this._unmarkSelected(d))}_verifyValueAssignment(d){}}let A=(()=>{class p{constructor(){this._listeners=[]}notify(c,f){for(let _ of this._listeners)_(c,f)}listen(c){return this._listeners.push(c),()=>{this._listeners=this._listeners.filter(f=>c!==f)}}ngOnDestroy(){this._listeners=[]}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275prov=N.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const R=new N.InjectionToken("_ViewRepeater")}}]);