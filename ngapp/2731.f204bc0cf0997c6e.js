"use strict";(self.webpackChunkngdemos=self.webpackChunkngdemos||[]).push([[2731],{7502:(J,w,l)=>{l.r(w),l.d(w,{TreeModule:()=>H});var P=l(6895),I=l(9116),r=l(4650),y=l(4169),F=l(529);class N extends y.EJ{constructor(t,e){super("DataSource",t,e)}}N.\u0275fac=function(t){return new(t||N)(r.\u0275\u0275inject(F.eN),r.\u0275\u0275inject(y.hR))},N.\u0275prov=r.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac});var R=l(4004),L=l(5698);class T extends y.c8{constructor(t){super("DataSource",t)}addOne(t){this.addOneToCache(t)}addMany(t){this.addManyToCache(t)}updateOne(t){this.updateOneInCache(t)}updateMany(t){this.updateManyInCache(t)}removeOne(t){this.removeOneFromCache(t)}removeMany(t){this.removeManyFromCache(t)}upsertOne(t){this.upsertOneInCache(t)}getAll(){return this.selectors$.entities$}getOne(t){const e="string"==typeof t?t:t.id;return this.selectors$.entities$.pipe((0,R.U)(i=>i.filter(s=>s.id===e)[0]),(0,L.q)(1))}patchOne(t,e){const i={children:[...t.children,e]},s={...t,...i};this.upsertOne(s)}}T.\u0275fac=function(t){return new(t||T)(r.\u0275\u0275inject(y.yV))},T.\u0275prov=r.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac});const m=n=>!!n&&"[object Object]"===Object.prototype.toString.call(n),b=n=>m(n)&&0===Object.keys(n).length,O=(n,t)=>typeof n==typeof t&&(Array.isArray(n)&&Array.isArray(t)?n.every((e,i)=>O(n[i],t[i])):m(n)&&m(t)?Object.keys(t).every(e=>Object.prototype.hasOwnProperty.call(n,e)&&O(n[e],t[e])):n===t);function k(n,t,e){if(void 0===n)return;const i=s=>{if(!m(s))return s;let o={...s};return O(o,t)&&(o={...e}),Object.keys(o).forEach(d=>{(m(o[d])||Array.isArray(o[d]))&&(o={...o,[d]:k(o[d],t,e)})}),o};return!Array.isArray(n)&&!m(n)||b(t)||b(e)?n:Array.isArray(n)?n.map(s=>i(s)):i(n)}function p(n,t,e){if(void 0===n)return;const i=s=>{if(!m(s))return s;let o={...s};return O(o,t)&&Object.keys(e).forEach(d=>{Object.prototype.hasOwnProperty.call(o,d)&&(o={...o,[d]:e[d]})}),Object.keys(o).forEach(d=>{(m(o[d])||Array.isArray(o[d]))&&(o={...o,[d]:p(o[d],t,e)})}),o};return!Array.isArray(n)&&!m(n)||b(t)||b(e)?n:Array.isArray(n)?n.map(s=>i(s)):i(n)}function a(n,t){if(void 0===n)return;const e=i=>{if(!m(i))return i;let s={...i};return Object.keys(s).forEach(o=>{(m(s[o])||Array.isArray(s[o]))&&(s={...s,[o]:a(s[o],t)})}),s};return!Array.isArray(n)&&!m(n)||b(t)?n:Array.isArray(n)?n.filter(i=>!O(i,t)).map(i=>e(i)):O(n,t)?void 0:e(n)}function M(n){if("object"!=typeof n||null===n)return n;if(Array.isArray(n))return function _(n,t){const e=Object.keys(n),i=new Array(e.length);for(const s of e){const o=n[s];i[s]="object"!=typeof o||null===o?o:t(o)}return i}(n,M);const t={};for(const e in n){if(!1===Object.hasOwnProperty.call(n,e))continue;const i=n[e];t[e]="object"!=typeof i||null===i?i:M(i)}return t}class v{constructor(t){this.dataSourceService=t,this.expandedNodes=new Set,this.flatNodeMap=new Map}toggleExpandedNodes(t,e,i=!1){let s=e.id||e.name;i?this.expandedNodes.delete(s):this.expandedNodes.add(s)}restoreExpandedNodes(t){this.expandedNodes.forEach(e=>{const i=t.dataNodes.find(s=>(s.id||s.name)===e);t.expand(i)})}getParent(t){const{treeControl:e}=this;if(e.getLevel(t)<1)return null;for(let o=e.dataNodes.indexOf(t)-1;o>=0;o--){const d=e.dataNodes[o];if(0===e.getLevel(d))return d}}updateNode(t,e){const i=this.getParent(t),s=this.flatNodeMap.get(i);this.dataSourceService.getOne(s.id).subscribe(o=>{const d=p(o,{name:t.name},e);this.dataSourceService.updateOne(d)})}addNodeToParent(t,e){t.children=[...t.children,e],this.dataSourceService.updateOne(t)}addNode(t,e){if(t.level){const i=this.flatNodeMap.get(t),s=this.getParent(t),o=this.flatNodeMap.get(s);this.dataSourceService.getOne(o.id).subscribe(d=>{const u={...i,children:[...i.children,e]},E=k(d,{name:t.name},u);this.dataSourceService.updateOne(E)})}else{const s=M(this.flatNodeMap.get(t));this.addNodeToParent(s,e)}}}v.\u0275fac=function(t){return new(t||v)(r.\u0275\u0275inject(T))},v.\u0275prov=r.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac});var C=l(5017),D=l(7579),x=l(1135),ie=l(5191),ue=l(9646),z=l(2722),W=l(1281),fe=l(445);class pe{constructor(){this.expansionModel=new C.Ov(!0)}toggle(t){this.expansionModel.toggle(this._trackByValue(t))}expand(t){this.expansionModel.select(this._trackByValue(t))}collapse(t){this.expansionModel.deselect(this._trackByValue(t))}isExpanded(t){return this.expansionModel.isSelected(this._trackByValue(t))}toggleDescendants(t){this.expansionModel.isSelected(this._trackByValue(t))?this.collapseDescendants(t):this.expandDescendants(t)}collapseAll(){this.expansionModel.clear()}expandDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.select(...e.map(i=>this._trackByValue(i)))}collapseDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.deselect(...e.map(i=>this._trackByValue(i)))}_trackByValue(t){return this.trackBy?this.trackBy(t):t}}class ge extends pe{constructor(t,e,i){super(),this.getLevel=t,this.isExpandable=e,this.options=i,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(t){const i=[];for(let s=this.dataNodes.indexOf(t)+1;s<this.dataNodes.length&&this.getLevel(t)<this.getLevel(this.dataNodes[s]);s++)i.push(this.dataNodes[s]);return i}expandAll(){this.expansionModel.select(...this.dataNodes.map(t=>this._trackByValue(t)))}}const X=new r.InjectionToken("CDK_TREE_NODE_OUTLET_NODE");let Q=(()=>{class n{constructor(e,i){this.viewContainer=e,this._node=i}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.ViewContainerRef),r.\u0275\u0275directiveInject(X,8))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","cdkTreeNodeOutlet",""]]}),n})();class me{constructor(t){this.$implicit=t}}let Z=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.TemplateRef))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),n})(),j=(()=>{class n{get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}constructor(e,i){this._differs=e,this._changeDetectorRef=i,this._onDestroy=new D.x,this._levels=new Map,this.viewChange=new x.X({start:0,end:Number.MAX_VALUE})}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const e=this._nodeDefs.filter(i=>!i.when);this._defaultNodeDef=e[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(e){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let e;(0,C.Z9)(this._dataSource)?e=this._dataSource.connect(this):(0,ie.b)(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=(0,ue.of)(this._dataSource)),e&&(this._dataSubscription=e.pipe((0,z.R)(this._onDestroy)).subscribe(i=>this.renderNodeChanges(i)))}renderNodeChanges(e,i=this._dataDiffer,s=this._nodeOutlet.viewContainer,o){const d=i.diff(e);d&&(d.forEachOperation((u,E,S)=>{if(null==u.previousIndex)this.insertNode(e[S],S,s,o);else if(null==S)s.remove(E),this._levels.delete(u.item);else{const re=s.get(E);s.move(re,S)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(e,i){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(o=>o.when&&o.when(i,e))||this._defaultNodeDef}insertNode(e,i,s,o){const d=this._getNodeDef(e,i),u=new me(e);u.level=this.treeControl.getLevel?this.treeControl.getLevel(e):typeof o<"u"&&this._levels.has(o)?this._levels.get(o)+1:0,this._levels.set(e,u.level),(s||this._nodeOutlet.viewContainer).createEmbeddedView(d.template,u,i),A.mostRecentTreeNode&&(A.mostRecentTreeNode.data=e)}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.IterableDiffers),r.\u0275\u0275directiveInject(r.ChangeDetectorRef))},n.\u0275cmp=r.\u0275\u0275defineComponent({type:n,selectors:[["cdk-tree"]],contentQueries:function(e,i,s){if(1&e&&r.\u0275\u0275contentQuery(s,Z,5),2&e){let o;r.\u0275\u0275queryRefresh(o=r.\u0275\u0275loadQuery())&&(i._nodeDefs=o)}},viewQuery:function(e,i){if(1&e&&r.\u0275\u0275viewQuery(Q,7),2&e){let s;r.\u0275\u0275queryRefresh(s=r.\u0275\u0275loadQuery())&&(i._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(e,i){1&e&&r.\u0275\u0275elementContainer(0,0)},dependencies:[Q],encapsulation:2}),n})(),A=(()=>{class n{get role(){return"treeitem"}set role(e){this._elementRef.nativeElement.setAttribute("role",e)}get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):this._parentNodeAriaLevel}constructor(e,i){this._elementRef=e,this._tree=i,this._destroyed=new D.x,this._dataChanges=new D.x,n.mostRecentTreeNode=this,this.role="treeitem"}ngOnInit(){this._parentNodeAriaLevel=function _e(n){let t=n.parentElement;for(;t&&!ve(t);)t=t.parentElement;return t?t.classList.contains("cdk-nested-tree-node")?(0,W.su)(t.getAttribute("aria-level")):0:-1}(this._elementRef.nativeElement),this._elementRef.nativeElement.setAttribute("aria-level",`${this.level+1}`)}ngOnDestroy(){n.mostRecentTreeNode===this&&(n.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return n.mostRecentTreeNode=null,n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(j))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:1,hostBindings:function(e,i){2&e&&r.\u0275\u0275attribute("aria-expanded",i.isExpanded)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),n})();function ve(n){const t=n.classList;return!(!t?.contains("cdk-nested-tree-node")&&!t?.contains("cdk-tree"))}const ye=/([A-Za-z%]+)$/;let ee=(()=>{class n{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}constructor(e,i,s,o){this._treeNode=e,this._tree=i,this._element=s,this._dir=o,this._destroyed=new D.x,this.indentUnits="px",this._indent=40,this._setPadding(),o&&o.change.pipe((0,z.R)(this._destroyed)).subscribe(()=>this._setPadding(!0)),e._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){const e=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,i=null==this._level?e:this._level;return"number"==typeof i?`${i*this._indent}${this.indentUnits}`:null}_setPadding(e=!1){const i=this._paddingIndent();if(i!==this._currentPadding||e){const s=this._element.nativeElement,o=this._dir&&"rtl"===this._dir.value?"paddingRight":"paddingLeft",d="paddingLeft"===o?"paddingRight":"paddingLeft";s.style[o]=i||"",s.style[d]="",this._currentPadding=i}}_setLevelInput(e){this._level=(0,W.su)(e,null),this._setPadding()}_setIndentInput(e){let i=e,s="px";if("string"==typeof e){const o=e.split(ye);i=o[0],s=o[1]||s}this.indentUnits=s,this._indent=(0,W.su)(i),this._setPadding()}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(A),r.\u0275\u0275directiveInject(j),r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(fe.Is,8))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:["cdkTreeNodePadding","level"],indent:["cdkTreeNodePaddingIndent","indent"]}}),n})(),te=(()=>{class n{get recursive(){return this._recursive}set recursive(e){this._recursive=(0,W.Ig)(e)}constructor(e,i){this._tree=e,this._treeNode=i,this._recursive=!1}_toggle(e){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),e.stopPropagation()}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(j),r.\u0275\u0275directiveInject(A))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(e,i){1&e&&r.\u0275\u0275listener("click",function(o){return i._toggle(o)})},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),n})(),Te=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=r.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=r.\u0275\u0275defineInjector({}),n})();var G=l(3238),De=l(6451);const Ce=(0,G.sb)((0,G.Id)(A));let se=(()=>{class n extends Ce{constructor(e,i,s){super(e,i),this.tabIndex=Number(s)||0}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.ElementRef),r.\u0275\u0275directiveInject(j),r.\u0275\u0275injectAttribute("tabindex"))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],inputs:{role:"role",disabled:"disabled",tabIndex:"tabIndex"},exportAs:["matTreeNode"],features:[r.\u0275\u0275ProvidersFeature([{provide:A,useExisting:n}]),r.\u0275\u0275InheritDefinitionFeature]}),n})(),oe=(()=>{class n extends Z{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=r.\u0275\u0275getInheritedFactory(n)))(i||n)}}(),n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[r.\u0275\u0275ProvidersFeature([{provide:Z,useExisting:n}]),r.\u0275\u0275InheritDefinitionFeature]}),n})(),ae=(()=>{class n extends ee{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=r.\u0275\u0275getInheritedFactory(n)))(i||n)}}(),n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","matTreeNodePadding",""]],inputs:{level:["matTreeNodePadding","level"],indent:["matTreeNodePaddingIndent","indent"]},features:[r.\u0275\u0275ProvidersFeature([{provide:ee,useExisting:n}]),r.\u0275\u0275InheritDefinitionFeature]}),n})(),ne=(()=>{class n{constructor(e,i){this.viewContainer=e,this._node=i}}return n.\u0275fac=function(e){return new(e||n)(r.\u0275\u0275directiveInject(r.ViewContainerRef),r.\u0275\u0275directiveInject(X,8))},n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","matTreeNodeOutlet",""]],features:[r.\u0275\u0275ProvidersFeature([{provide:Q,useExisting:n}])]}),n})(),de=(()=>{class n extends j{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=r.\u0275\u0275getInheritedFactory(n)))(i||n)}}(),n.\u0275cmp=r.\u0275\u0275defineComponent({type:n,selectors:[["mat-tree"]],viewQuery:function(e,i){if(1&e&&r.\u0275\u0275viewQuery(ne,7),2&e){let s;r.\u0275\u0275queryRefresh(s=r.\u0275\u0275loadQuery())&&(i._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[r.\u0275\u0275ProvidersFeature([{provide:j,useExisting:n}]),r.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(e,i){1&e&&r.\u0275\u0275elementContainer(0,0)},dependencies:[ne],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}"],encapsulation:2}),n})(),ce=(()=>{class n extends te{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=r.\u0275\u0275getInheritedFactory(n)))(i||n)}}(),n.\u0275dir=r.\u0275\u0275defineDirective({type:n,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[r.\u0275\u0275ProvidersFeature([{provide:te,useExisting:n}]),r.\u0275\u0275InheritDefinitionFeature]}),n})(),Ne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=r.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=r.\u0275\u0275defineInjector({imports:[Te,G.BQ,G.BQ]}),n})();class Me{constructor(t,e,i,s){this.transformFunction=t,this.getLevel=e,this.isExpandable=i,this.getChildren=s}_flattenNode(t,e,i,s){const o=this.transformFunction(t,e);if(i.push(o),this.isExpandable(o)){const d=this.getChildren(t);d&&(Array.isArray(d)?this._flattenChildren(d,e,i,s):d.pipe((0,L.q)(1)).subscribe(u=>{this._flattenChildren(u,e,i,s)}))}return i}_flattenChildren(t,e,i,s){t.forEach((o,d)=>{let u=s.slice();u.push(d!=t.length-1),this._flattenNode(o,e+1,i,u)})}flattenNodes(t){let e=[];return t.forEach(i=>this._flattenNode(i,0,e,[])),e}expandFlattenedNodes(t,e){let i=[],s=[];return s[0]=!0,t.forEach(o=>{let d=!0;for(let u=0;u<=this.getLevel(o);u++)d=d&&s[u];d&&i.push(o),this.isExpandable(o)&&(s[this.getLevel(o)+1]=e.isExpanded(o))}),i}}class Se extends C.o2{get data(){return this._data.value}set data(t){this._data.next(t),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}constructor(t,e,i){super(),this._treeControl=t,this._treeFlattener=e,this._flattenedData=new x.X([]),this._expandedData=new x.X([]),this._data=new x.X([]),i&&(this.data=i)}connect(t){return(0,De.T)(t.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,R.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}const be=[{id:"componentsID",name:"components",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"angularID",name:"angular",type:"folder",children:[{name:"packages",type:"folder",children:[{name:".travis.yml",type:"file"},{name:"firebase.json",type:"file"},{name:"firebase1.json",type:"file",work:"None"},{name:"firebase2.json",type:"file"}]},{name:"package.json",type:"file"}]},{id:"angularjsID",name:"angularjs",type:"folder",children:[{name:"gulpfile.js",type:"file"},{name:"README.md",type:"file"}]}];var le=l(7392),Y=l(4859);function Oe(n,t){if(1&n){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"mat-tree-node",3),r.\u0275\u0275element(1,"button",4)(2,"i",5),r.\u0275\u0275text(3),r.\u0275\u0275elementStart(4,"button",6),r.\u0275\u0275listener("click",function(){const o=r.\u0275\u0275restoreView(e).$implicit,d=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(d.editNode(o))}),r.\u0275\u0275element(5,"i",7),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(6,"button",8),r.\u0275\u0275listener("click",function(){const o=r.\u0275\u0275restoreView(e).$implicit,d=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(d.deleteNode(o))}),r.\u0275\u0275element(7,"i",9),r.\u0275\u0275elementEnd()()}if(2&n){const e=t.$implicit;r.\u0275\u0275advance(2),r.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),r.\u0275\u0275attribute("aria-label",e.type+"icon"),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",e.name," ")}}function xe(n,t){if(1&n){const e=r.\u0275\u0275getCurrentView();r.\u0275\u0275elementStart(0,"mat-tree-node",10)(1,"button",11),r.\u0275\u0275element(2,"i",12),r.\u0275\u0275elementEnd(),r.\u0275\u0275element(3,"mat-icon"),r.\u0275\u0275text(4),r.\u0275\u0275elementStart(5,"button",13),r.\u0275\u0275listener("click",function(){const o=r.\u0275\u0275restoreView(e).$implicit,d=r.\u0275\u0275nextContext();return r.\u0275\u0275resetView(d.addNode(o))}),r.\u0275\u0275element(6,"i",14),r.\u0275\u0275elementEnd()()}if(2&n){const e=t.$implicit,i=r.\u0275\u0275nextContext();r.\u0275\u0275advance(1),r.\u0275\u0275attribute("aria-label","Toggle "+e.name),r.\u0275\u0275advance(1),r.\u0275\u0275classProp("ti-angle-down",i.expandedElement!==i.element)("ti-angle-right",i.expandedElement===i.element),r.\u0275\u0275advance(1),r.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),r.\u0275\u0275attribute("aria-label",e.type+"icon"),r.\u0275\u0275advance(1),r.\u0275\u0275textInterpolate1(" ",e.name," ")}}class K{constructor(t,e){this.dataSourceService=t,this.dsHelperService=e,this.editNodeChange=new r.EventEmitter,this.addNodeChange=new r.EventEmitter,this.activeNode=null,this.transformer=(i,s)=>{const o={...i.id&&{id:i.id},name:i.name,type:i.type,level:s,expandable:!!i.children};return this.dsHelperService.flatNodeMap.set(o,i),o},this.treeFlattener=new Me(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new ge(this.getLevel,this.isExpandable),this.dataSource=new Se(this.treeControl,this.treeFlattener),this.dsHelperService.treeFlattener=this.treeFlattener,this.dsHelperService.treeControl=this.treeControl}ngOnInit(){this.initializeData(),this.handleExpandedNodes()}editNode(t){this.editNodeChange.emit(t)}initializeData(){this.dataSourceService.addManyToCache(be),this.dataSources$=this.dataSourceService.entities$,this.dataSources$.subscribe(t=>{this.dataSource.data=t,this.dsHelperService.restoreExpandedNodes(this.treeControl)})}getLevel(t){return t.level}isExpandable(t){return t.expandable}hasChild(t,e){return e.expandable}getChildren(t){return t.children}handleExpandedNodes(){this.treeControl.expansionModel.changed.subscribe(t=>{t.added[0]&&t.added.length?this.dsHelperService.toggleExpandedNodes(this.treeControl,t.added[0]):t.removed.length&&t.removed.forEach(e=>{this.dsHelperService.toggleExpandedNodes(this.treeControl,e,!0)})})}deleteNode(t){const e=this.dsHelperService.getParent(t),i=this.dsHelperService.flatNodeMap.get(e);this.dataSourceService.getOne(i.id).subscribe(s=>{const o=a(s,{name:t.name});this.dataSourceService.updateOne(o)})}addNode(t){this.addNodeChange.emit(t)}}K.\u0275fac=function(t){return new(t||K)(r.\u0275\u0275directiveInject(T),r.\u0275\u0275directiveInject(v))},K.\u0275cmp=r.\u0275\u0275defineComponent({type:K,selectors:[["lib-data-source-list"]],outputs:{editNodeChange:"editNodeChange",addNodeChange:"addNodeChange"},decls:3,vars:3,consts:[[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"type-icon"],["mat-icon-button","","color","accent",1,"icon-btn","edit",3,"click"],[1,"ti-pencil"],["mat-icon-button","","color","warn",1,"icon-btn","delete",3,"click"],[1,"ti-trash"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["mat-icon-button","","color","accent",3,"click"],[1,"ti-plus"]],template:function(t,e){1&t&&(r.\u0275\u0275elementStart(0,"mat-tree",0),r.\u0275\u0275template(1,Oe,8,6,"mat-tree-node",1),r.\u0275\u0275template(2,xe,7,11,"mat-tree-node",2),r.\u0275\u0275elementEnd()),2&t&&(r.\u0275\u0275property("dataSource",e.dataSource)("treeControl",e.treeControl),r.\u0275\u0275advance(2),r.\u0275\u0275property("matTreeNodeDefWhen",e.hasChild))},dependencies:[oe,ae,ce,de,se,le.Hw,Y.RK],styles:[".type-icon[_ngcontent-%COMP%]{color:#757575;margin-right:5px}.icon-btn[_ngcontent-%COMP%]{margin-left:10px}.edit[_ngcontent-%COMP%]     .mat-icon, .delete[_ngcontent-%COMP%]     .mat-icon{font-size:18px}.ti-folder[_ngcontent-%COMP%]{margin-top:8px}"]});const Ae={DataSource:{selectId(n){if(null!==n)return n.id||n.name?`${n.id||n.name}`:n._id},entityDispatcherOptions:{optimisticUpdate:!0}}};class V{constructor(t,e,i){this.eds=t,this.entityDataService=e,this.dataSourceService=i,this.eds.registerMetadataMap(Ae),this.entityDataService.registerService("DataSource",this.dataSourceService)}}V.\u0275fac=function(t){return new(t||V)(r.\u0275\u0275inject(y.f0),r.\u0275\u0275inject(y.sP),r.\u0275\u0275inject(N))},V.\u0275mod=r.\u0275\u0275defineNgModule({type:V}),V.\u0275inj=r.\u0275\u0275defineInjector({providers:[N,T,v],imports:[Ne,le.Ps,Y.ot]});class ${constructor(t,e){this.dataSourceService=t,this.dsHelperService=e}ngOnInit(){}addOne(){this.dataSourceService.addOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}addMany(){this.dataSourceService.addMany([{id:"TESTIDMANY",name:"Test add many",type:"folder",children:[{name:"src many",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsIDMANY",name:"components many 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}upsertOne(){this.dataSourceService.upsertOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}removeOne(){this.dataSourceService.removeOne("TESTID")}removeMany(){this.dataSourceService.removeMany(["TESTID","componentsID"])}updateOne(){this.dataSourceService.updateOne({id:"TESTID",name:"Test 1",type:"folder",children:[{name:"src 1",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}updateMany(){this.dataSourceService.updateMany([{id:"TESTID",name:"Test 2",type:"folder",children:[{name:"src 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsID",name:"components 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}getOne(){this.dataSourceService.getOne("TESTID").subscribe(console.log)}patchOne(){this.dataSourceService.patchOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"TESTIDWOrker",name:"Worker",type:"folder",children:[{id:"TESTIDWOrker2",name:"Worker 2",type:"file"}]})}getFlattenNodes(){console.log("HERREE ",this.dsHelperService.treeFlattener),console.log("Flatten nodes with treeControl ",this.dsHelperService.treeControl.dataNodes),this.dataSourceService.getAll().subscribe(t=>{console.log("Node matrix ",t),console.log("Flatten Nodes ",this.dsHelperService.treeFlattener.flattenNodes(t))})}onNodeEdit(t){const e=this.dsHelperService.flatNodeMap.get(t);this.dsHelperService.updateNode(t,{...e,name:e.name+" UPDATED!"})}onNodeAdd(t){this.dsHelperService.flatNodeMap.get(t),this.dsHelperService.addNode(t,{id:"addNodeID",name:"My New node",type:"file"})}}$.\u0275fac=function(t){return new(t||$)(r.\u0275\u0275directiveInject(T),r.\u0275\u0275directiveInject(v))},$.\u0275cmp=r.\u0275\u0275defineComponent({type:$,selectors:[["app-tree"]],decls:27,vars:0,consts:[[1,"container"],[1,"col"],[3,"editNodeChange","addNodeChange"],[1,"col","action"],["mat-button","","mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(r.\u0275\u0275elementStart(0,"header")(1,"h1"),r.\u0275\u0275text(2,"Tree Demo"),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementStart(3,"div",0)(4,"div",1)(5,"lib-data-source-list",2),r.\u0275\u0275listener("editNodeChange",function(s){return e.onNodeEdit(s)})("addNodeChange",function(s){return e.onNodeAdd(s)}),r.\u0275\u0275elementEnd()(),r.\u0275\u0275elementStart(6,"div",3)(7,"button",4),r.\u0275\u0275listener("click",function(){return e.addOne()}),r.\u0275\u0275text(8," Add DS "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(9,"button",4),r.\u0275\u0275listener("click",function(){return e.addMany()}),r.\u0275\u0275text(10," Add Many "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(11,"button",4),r.\u0275\u0275listener("click",function(){return e.upsertOne()}),r.\u0275\u0275text(12," Upsert One "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(13,"button",4),r.\u0275\u0275listener("click",function(){return e.removeOne()}),r.\u0275\u0275text(14," Remove One "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(15,"button",4),r.\u0275\u0275listener("click",function(){return e.removeMany()}),r.\u0275\u0275text(16," Remove Many "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(17,"button",4),r.\u0275\u0275listener("click",function(){return e.updateOne()}),r.\u0275\u0275text(18," Update One "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(19,"button",4),r.\u0275\u0275listener("click",function(){return e.updateMany()}),r.\u0275\u0275text(20," Update Many "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(21,"button",4),r.\u0275\u0275listener("click",function(){return e.getOne()}),r.\u0275\u0275text(22," Get One "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(23,"button",4),r.\u0275\u0275listener("click",function(){return e.patchOne()}),r.\u0275\u0275text(24," Patch One "),r.\u0275\u0275elementEnd(),r.\u0275\u0275elementStart(25,"button",4),r.\u0275\u0275listener("click",function(){return e.getFlattenNodes()}),r.\u0275\u0275text(26," Get Flatten Nodes "),r.\u0275\u0275elementEnd()()())},dependencies:[Y.lW,K],styles:["header[_ngcontent-%COMP%]{margin:20px}.container[_ngcontent-%COMP%]{grid-gap:20px;margin:20px;display:grid;grid-template-columns:3fr 1fr}.action[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:4px}"]});const Ie=[{path:"",component:$}];class U{}U.\u0275fac=function(t){return new(t||U)},U.\u0275mod=r.\u0275\u0275defineNgModule({type:U}),U.\u0275inj=r.\u0275\u0275defineInjector({imports:[I.Bz.forChild(Ie),I.Bz]});class H{}H.\u0275fac=function(t){return new(t||H)},H.\u0275mod=r.\u0275\u0275defineNgModule({type:H}),H.\u0275inj=r.\u0275\u0275defineInjector({imports:[P.ez,U,Y.ot,V]})},4128:(J,w,l)=>{l.d(w,{D:()=>L});var P=l(9751),I=l(4742),r=l(8421),y=l(3269),F=l(5403),N=l(3268),R=l(1810);function L(...T){const m=(0,y.jO)(T),{args:b,keys:O}=(0,I.D)(T),B=new P.y(k=>{const{length:p}=b;if(!p)return void k.complete();const a=new Array(p);let c=p,h=p;for(let g=0;g<p;g++){let f=!1;(0,r.Xf)(b[g]).subscribe((0,F.x)(k,_=>{f||(f=!0,h--),a[g]=_},()=>c--,void 0,()=>{(!c||!f)&&(h||k.next(O?(0,R.n)(O,a):a),k.complete())}))}});return m?B.pipe((0,N.Z)(m)):B}},5191:(J,w,l)=>{l.d(w,{b:()=>r});var P=l(9751),I=l(576);function r(y){return!!y&&(y instanceof P.y||(0,I.m)(y.lift)&&(0,I.m)(y.subscribe))}},5017:(J,w,l)=>{l.d(w,{A8:()=>B,Ov:()=>b,P3:()=>L,Z9:()=>R,eX:()=>m,k:()=>k,o2:()=>N,yy:()=>T});var P=l(4033),I=l(5191),r=l(9646),y=l(7579),F=l(4650);class N{}function R(p){return p&&"function"==typeof p.connect&&!(p instanceof P.c)}class L extends N{constructor(a){super(),this._data=a}connect(){return(0,I.b)(this._data)?this._data:(0,r.of)(this._data)}disconnect(){}}class T{applyChanges(a,c,h,g,f){a.forEachOperation((_,M,v)=>{let C,D;if(null==_.previousIndex){const x=h(_,M,v);C=c.createEmbeddedView(x.templateRef,x.context,x.index),D=1}else null==v?(c.remove(M),D=3):(C=c.get(M),c.move(C,v),D=2);f&&f({context:C?.context,operation:D,record:_})})}detach(){}}class m{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(a,c,h,g,f){a.forEachOperation((_,M,v)=>{let C,D;null==_.previousIndex?(C=this._insertView(()=>h(_,M,v),v,c,g(_)),D=C?1:0):null==v?(this._detachAndCacheView(M,c),D=3):(C=this._moveView(M,v,c,g(_)),D=2),f&&f({context:C?.context,operation:D,record:_})})}detach(){for(const a of this._viewCache)a.destroy();this._viewCache=[]}_insertView(a,c,h,g){const f=this._insertViewFromCache(c,h);if(f)return void(f.context.$implicit=g);const _=a();return h.createEmbeddedView(_.templateRef,_.context,_.index)}_detachAndCacheView(a,c){const h=c.detach(a);this._maybeCacheView(h,c)}_moveView(a,c,h,g){const f=h.get(a);return h.move(f,c),f.context.$implicit=g,f}_maybeCacheView(a,c){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(a);else{const h=c.indexOf(a);-1===h?a.destroy():c.remove(h)}}_insertViewFromCache(a,c){const h=this._viewCache.pop();return h&&c.insert(h,a),h||null}}class b{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(a=!1,c,h=!0,g){this._multiple=a,this._emitChanges=h,this.compareWith=g,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new y.x,c&&c.length&&(a?c.forEach(f=>this._markSelected(f)):this._markSelected(c[0]),this._selectedToEmit.length=0)}select(...a){this._verifyValueAssignment(a),a.forEach(h=>this._markSelected(h));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}deselect(...a){this._verifyValueAssignment(a),a.forEach(h=>this._unmarkSelected(h));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}setSelection(...a){this._verifyValueAssignment(a);const c=this.selected,h=new Set(a);a.forEach(f=>this._markSelected(f)),c.filter(f=>!h.has(f)).forEach(f=>this._unmarkSelected(f));const g=this._hasQueuedChanges();return this._emitChangeEvent(),g}toggle(a){return this.isSelected(a)?this.deselect(a):this.select(a)}clear(a=!0){this._unmarkAll();const c=this._hasQueuedChanges();return a&&this._emitChangeEvent(),c}isSelected(a){if(this.compareWith){for(const c of this._selection)if(this.compareWith(c,a))return!0;return!1}return this._selection.has(a)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(a){this._multiple&&this.selected&&this._selected.sort(a)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(a){this.isSelected(a)||(this._multiple||this._unmarkAll(),this.isSelected(a)||this._selection.add(a),this._emitChanges&&this._selectedToEmit.push(a))}_unmarkSelected(a){this.isSelected(a)&&(this._selection.delete(a),this._emitChanges&&this._deselectedToEmit.push(a))}_unmarkAll(){this.isEmpty()||this._selection.forEach(a=>this._unmarkSelected(a))}_verifyValueAssignment(a){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}}let B=(()=>{class p{constructor(){this._listeners=[]}notify(c,h){for(let g of this._listeners)g(c,h)}listen(c){return this._listeners.push(c),()=>{this._listeners=this._listeners.filter(h=>c!==h)}}ngOnDestroy(){this._listeners=[]}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275prov=F.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const k=new F.InjectionToken("_ViewRepeater")}}]);