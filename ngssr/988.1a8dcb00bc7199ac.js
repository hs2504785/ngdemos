"use strict";(self.webpackChunkngdemos=self.webpackChunkngdemos||[]).push([[988],{8896:(J,P,l)=>{l.r(P),l.d(P,{TreeModule:()=>Ae});var B=l(4755),F=l(9085),n=l(2223),S=l(4169),k=l(4004),I=l(5698);let A=(()=>{class t extends S.c8{constructor(e){super("DataSource",e)}addOne(e){this.addOneToCache(e)}addMany(e){this.addManyToCache(e)}updateOne(e){this.updateOneInCache(e)}updateMany(e){this.updateManyInCache(e)}removeOne(e){this.removeOneFromCache(e)}removeMany(e){this.removeManyFromCache(e)}upsertOne(e){this.upsertOneInCache(e)}getAll(){return this.selectors$.entities$}getOne(e){const r="string"==typeof e?e:e.id;return this.selectors$.entities$.pipe((0,k.U)(s=>s.filter(o=>o.id===r)[0]),(0,I.q)(1))}patchOne(e,r){const s={children:[...e.children,r]},o={...e,...s};this.upsertOne(o)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(S.yV))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();const _=t=>!!t&&"[object Object]"===Object.prototype.toString.call(t),M=t=>_(t)&&0===Object.keys(t).length,E=(t,i)=>typeof t==typeof i&&(Array.isArray(t)&&Array.isArray(i)?t.every((e,r)=>E(t[r],i[r])):_(t)&&_(i)?Object.keys(i).every(e=>Object.prototype.hasOwnProperty.call(t,e)&&E(t[e],i[e])):t===i);function L(t,i,e){if(void 0===t)return;const r=s=>{if(!_(s))return s;let o={...s};return E(o,i)&&(o={...e}),Object.keys(o).forEach(d=>{(_(o[d])||Array.isArray(o[d]))&&(o={...o,[d]:L(o[d],i,e)})}),o};return!Array.isArray(t)&&!_(t)||M(i)||M(e)?t:Array.isArray(t)?t.map(s=>r(s)):r(t)}function j(t,i,e){if(void 0===t)return;const r=s=>{if(!_(s))return s;let o={...s};return E(o,i)&&Object.keys(e).forEach(d=>{Object.prototype.hasOwnProperty.call(o,d)&&(o={...o,[d]:e[d]})}),Object.keys(o).forEach(d=>{(_(o[d])||Array.isArray(o[d]))&&(o={...o,[d]:j(o[d],i,e)})}),o};return!Array.isArray(t)&&!_(t)||M(i)||M(e)?t:Array.isArray(t)?t.map(s=>r(s)):r(t)}function O(t,i){if(void 0===t)return;const e=r=>{if(!_(r))return r;let s={...r};return Object.keys(s).forEach(o=>{(_(s[o])||Array.isArray(s[o]))&&(s={...s,[o]:O(s[o],i)})}),s};return!Array.isArray(t)&&!_(t)||M(i)?t:Array.isArray(t)?t.filter(r=>!E(r,i)).map(r=>e(r)):E(t,i)?void 0:e(t)}function f(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))return function g(t,i){const e=Object.keys(t),r=new Array(e.length);for(const s of e){const o=t[s];r[s]="object"!=typeof o||null===o?o:i(o)}return r}(t,f);const i={};for(const e in t){if(!1===Object.hasOwnProperty.call(t,e))continue;const r=t[e];i[e]="object"!=typeof r||null===r?r:f(r)}return i}let m=(()=>{class t{constructor(e){this.dataSourceService=e,this.expandedNodes=new Set,this.flatNodeMap=new Map}toggleExpandedNodes(e,r,s=!1){let o=r.id||r.name;s?this.expandedNodes.delete(o):this.expandedNodes.add(o)}restoreExpandedNodes(e){this.expandedNodes.forEach(r=>{const s=e.dataNodes.find(o=>(o.id||o.name)===r);e.expand(s)})}getParent(e){const{treeControl:r}=this;if(r.getLevel(e)<1)return null;for(let d=r.dataNodes.indexOf(e)-1;d>=0;d--){const u=r.dataNodes[d];if(0===r.getLevel(u))return u}}updateNode(e,r){const s=this.getParent(e),o=this.flatNodeMap.get(s);this.dataSourceService.getOne(o.id).subscribe(d=>{const u=j(d,{name:e.name},r);this.dataSourceService.updateOne(u)})}addNodeToParent(e,r){e.children=[...e.children,r],this.dataSourceService.updateOne(e)}addNode(e,r){if(e.level){const s=this.flatNodeMap.get(e),o=this.getParent(e),d=this.flatNodeMap.get(o);this.dataSourceService.getOne(d.id).subscribe(u=>{const T={...s,children:[...s.children,r]},D=L(u,{name:e.name},T);this.dataSourceService.updateOne(D)})}else{const o=f(this.flatNodeMap.get(e));this.addNodeToParent(o,r)}}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(A))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();var N=l(418),v=l(7579),y=l(1135),C=l(5191),w=l(9646),H=l(2722),V=l(1692),ae=l(8930);class de{constructor(){this.expansionModel=new N.Ov(!0)}toggle(i){this.expansionModel.toggle(this._trackByValue(i))}expand(i){this.expansionModel.select(this._trackByValue(i))}collapse(i){this.expansionModel.deselect(this._trackByValue(i))}isExpanded(i){return this.expansionModel.isSelected(this._trackByValue(i))}toggleDescendants(i){this.expansionModel.isSelected(this._trackByValue(i))?this.collapseDescendants(i):this.expandDescendants(i)}collapseAll(){this.expansionModel.clear()}expandDescendants(i){let e=[i];e.push(...this.getDescendants(i)),this.expansionModel.select(...e.map(r=>this._trackByValue(r)))}collapseDescendants(i){let e=[i];e.push(...this.getDescendants(i)),this.expansionModel.deselect(...e.map(r=>this._trackByValue(r)))}_trackByValue(i){return this.trackBy?this.trackBy(i):i}}class ce extends de{constructor(i,e,r){super(),this.getLevel=i,this.isExpandable=e,this.options=r,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(i){const r=[];for(let s=this.dataNodes.indexOf(i)+1;s<this.dataNodes.length&&this.getLevel(i)<this.getLevel(this.dataNodes[s]);s++)r.push(this.dataNodes[s]);return r}expandAll(){this.expansionModel.select(...this.dataNodes.map(i=>this._trackByValue(i)))}}const Q=new n.InjectionToken("CDK_TREE_NODE_OUTLET_NODE");let U=(()=>{class t{constructor(e,r){this.viewContainer=e,this._node=r}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ViewContainerRef),n.\u0275\u0275directiveInject(Q,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeOutlet",""]]}),t})();class le{constructor(i){this.$implicit=i}}let W=(()=>{class t{constructor(e){this.template=e}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.TemplateRef))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),x=(()=>{class t{get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}constructor(e,r){this._differs=e,this._changeDetectorRef=r,this._onDestroy=new v.x,this._levels=new Map,this.viewChange=new y.X({start:0,end:Number.MAX_VALUE})}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const e=this._nodeDefs.filter(r=>!r.when);this._defaultNodeDef=e[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(e){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let e;(0,N.Z9)(this._dataSource)?e=this._dataSource.connect(this):(0,C.b)(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=(0,w.of)(this._dataSource)),e&&(this._dataSubscription=e.pipe((0,H.R)(this._onDestroy)).subscribe(r=>this.renderNodeChanges(r)))}renderNodeChanges(e,r=this._dataDiffer,s=this._nodeOutlet.viewContainer,o){const d=r.diff(e);d&&(d.forEachOperation((u,T,D)=>{if(null==u.previousIndex)this.insertNode(e[D],D,s,o);else if(null==D)s.remove(T),this._levels.delete(u.item);else{const Y=s.get(T);s.move(Y,D)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(e,r){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(o=>o.when&&o.when(r,e))||this._defaultNodeDef}insertNode(e,r,s,o){const d=this._getNodeDef(e,r),u=new le(e);u.level=this.treeControl.getLevel?this.treeControl.getLevel(e):typeof o<"u"&&this._levels.has(o)?this._levels.get(o)+1:0,this._levels.set(e,u.level),(s||this._nodeOutlet.viewContainer).createEmbeddedView(d.template,u,r),b.mostRecentTreeNode&&(b.mostRecentTreeNode.data=e)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.IterableDiffers),n.\u0275\u0275directiveInject(n.ChangeDetectorRef))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["cdk-tree"]],contentQueries:function(e,r,s){if(1&e&&n.\u0275\u0275contentQuery(s,W,5),2&e){let o;n.\u0275\u0275queryRefresh(o=n.\u0275\u0275loadQuery())&&(r._nodeDefs=o)}},viewQuery:function(e,r){if(1&e&&n.\u0275\u0275viewQuery(U,7),2&e){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(r._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(e,r){1&e&&n.\u0275\u0275elementContainer(0,0)},dependencies:[U],encapsulation:2}),t})(),b=(()=>{class t{get role(){return"treeitem"}set role(e){this._elementRef.nativeElement.setAttribute("role",e)}get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):this._parentNodeAriaLevel}constructor(e,r){this._elementRef=e,this._tree=r,this._destroyed=new v.x,this._dataChanges=new v.x,t.mostRecentTreeNode=this,this.role="treeitem"}ngOnInit(){this._parentNodeAriaLevel=function ue(t){let i=t.parentElement;for(;i&&!he(i);)i=i.parentElement;return i?i.classList.contains("cdk-nested-tree-node")?(0,V.su)(i.getAttribute("aria-level")):0:-1}(this._elementRef.nativeElement),this._elementRef.nativeElement.setAttribute("aria-level",`${this.level+1}`)}ngOnDestroy(){t.mostRecentTreeNode===this&&(t.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return t.mostRecentTreeNode=null,t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(x))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:1,hostBindings:function(e,r){2&e&&n.\u0275\u0275attribute("aria-expanded",r.isExpanded)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),t})();function he(t){const i=t.classList;return!(!i?.contains("cdk-nested-tree-node")&&!i?.contains("cdk-tree"))}const fe=/([A-Za-z%]+)$/;let X=(()=>{class t{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}constructor(e,r,s,o){this._treeNode=e,this._tree=r,this._element=s,this._dir=o,this._destroyed=new v.x,this.indentUnits="px",this._indent=40,this._setPadding(),o&&o.change.pipe((0,H.R)(this._destroyed)).subscribe(()=>this._setPadding(!0)),e._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){const e=this._treeNode.data&&this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._treeNode.data):null,r=null==this._level?e:this._level;return"number"==typeof r?`${r*this._indent}${this.indentUnits}`:null}_setPadding(e=!1){const r=this._paddingIndent();if(r!==this._currentPadding||e){const s=this._element.nativeElement,o=this._dir&&"rtl"===this._dir.value?"paddingRight":"paddingLeft",d="paddingLeft"===o?"paddingRight":"paddingLeft";s.style[o]=r||"",s.style[d]="",this._currentPadding=r}}_setLevelInput(e){this._level=(0,V.su)(e,null),this._setPadding()}_setIndentInput(e){let r=e,s="px";if("string"==typeof e){const o=e.split(fe);r=o[0],s=o[1]||s}this.indentUnits=s,this._indent=(0,V.su)(r),this._setPadding()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(b),n.\u0275\u0275directiveInject(x),n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(ae.Is,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:["cdkTreeNodePadding","level"],indent:["cdkTreeNodePaddingIndent","indent"]}}),t})(),Z=(()=>{class t{get recursive(){return this._recursive}set recursive(e){this._recursive=(0,V.Ig)(e)}constructor(e,r){this._tree=e,this._treeNode=r,this._recursive=!1}_toggle(e){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),e.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(x),n.\u0275\u0275directiveInject(b))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(e,r){1&e&&n.\u0275\u0275listener("click",function(o){return r._toggle(o)})},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),t})(),pe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({}),t})();var $=l(1217),ge=l(6451);const me=(0,$.sb)((0,$.Id)(b));let q=(()=>{class t extends me{constructor(e,r,s){super(e,r),this.tabIndex=Number(s)||0}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(x),n.\u0275\u0275injectAttribute("tabindex"))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],inputs:{role:"role",disabled:"disabled",tabIndex:"tabIndex"},exportAs:["matTreeNode"],features:[n.\u0275\u0275ProvidersFeature([{provide:b,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),ee=(()=>{class t extends W{}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[n.\u0275\u0275ProvidersFeature([{provide:W,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),te=(()=>{class t extends X{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodePadding",""]],inputs:{level:["matTreeNodePadding","level"],indent:["matTreeNodePaddingIndent","indent"]},features:[n.\u0275\u0275ProvidersFeature([{provide:X,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),G=(()=>{class t{constructor(e,r){this.viewContainer=e,this._node=r}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(n.ViewContainerRef),n.\u0275\u0275directiveInject(Q,8))},t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeOutlet",""]],features:[n.\u0275\u0275ProvidersFeature([{provide:U,useExisting:t}])]}),t})(),ne=(()=>{class t extends x{constructor(){super(...arguments),this._nodeOutlet=void 0}}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["mat-tree"]],viewQuery:function(e,r){if(1&e&&n.\u0275\u0275viewQuery(G,7),2&e){let s;n.\u0275\u0275queryRefresh(s=n.\u0275\u0275loadQuery())&&(r._nodeOutlet=s.first)}},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[n.\u0275\u0275ProvidersFeature([{provide:x,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(e,r){1&e&&n.\u0275\u0275elementContainer(0,0)},dependencies:[G],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}"],encapsulation:2}),t})(),re=(()=>{class t extends Z{}return t.\u0275fac=function(){let i;return function(r){return(i||(i=n.\u0275\u0275getInheritedFactory(t)))(r||t)}}(),t.\u0275dir=n.\u0275\u0275defineDirective({type:t,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[n.\u0275\u0275ProvidersFeature([{provide:Z,useExisting:t}]),n.\u0275\u0275InheritDefinitionFeature]}),t})(),ye=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({imports:[pe,$.BQ,$.BQ]}),t})();class ve{constructor(i,e,r,s){this.transformFunction=i,this.getLevel=e,this.isExpandable=r,this.getChildren=s}_flattenNode(i,e,r,s){const o=this.transformFunction(i,e);if(r.push(o),this.isExpandable(o)){const d=this.getChildren(i);d&&(Array.isArray(d)?this._flattenChildren(d,e,r,s):d.pipe((0,I.q)(1)).subscribe(u=>{this._flattenChildren(u,e,r,s)}))}return r}_flattenChildren(i,e,r,s){i.forEach((o,d)=>{let u=s.slice();u.push(d!=i.length-1),this._flattenNode(o,e+1,r,u)})}flattenNodes(i){let e=[];return i.forEach(r=>this._flattenNode(r,0,e,[])),e}expandFlattenedNodes(i,e){let r=[],s=[];return s[0]=!0,i.forEach(o=>{let d=!0;for(let u=0;u<=this.getLevel(o);u++)d=d&&s[u];d&&r.push(o),this.isExpandable(o)&&(s[this.getLevel(o)+1]=e.isExpanded(o))}),r}}class Te extends N.o2{get data(){return this._data.value}set data(i){this._data.next(i),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}constructor(i,e,r){super(),this._treeControl=i,this._treeFlattener=e,this._flattenedData=new y.X([]),this._expandedData=new y.X([]),this._data=new y.X([]),r&&(this.data=r)}connect(i){return(0,ge.T)(i.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,k.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}const De=[{id:"componentsID",name:"components",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"angularID",name:"angular",type:"folder",children:[{name:"packages",type:"folder",children:[{name:".travis.yml",type:"file"},{name:"firebase.json",type:"file"},{name:"firebase1.json",type:"file",work:"None"},{name:"firebase2.json",type:"file"}]},{name:"package.json",type:"file"}]},{id:"angularjsID",name:"angularjs",type:"folder",children:[{name:"gulpfile.js",type:"file"},{name:"README.md",type:"file"}]}];var ie=l(430),z=l(1728);function Ce(t,i){if(1&t){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-tree-node",3),n.\u0275\u0275element(1,"button",4)(2,"i",5),n.\u0275\u0275text(3),n.\u0275\u0275elementStart(4,"button",6),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit,d=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(d.editNode(o))}),n.\u0275\u0275element(5,"i",7),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"button",8),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit,d=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(d.deleteNode(o))}),n.\u0275\u0275element(7,"i",9),n.\u0275\u0275elementEnd()()}if(2&t){const e=i.$implicit;n.\u0275\u0275advance(2),n.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),n.\u0275\u0275attribute("aria-label",e.type+"icon"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",e.name," ")}}function Ee(t,i){if(1&t){const e=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"mat-tree-node",10)(1,"button",11),n.\u0275\u0275element(2,"i",12),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(3,"mat-icon"),n.\u0275\u0275text(4),n.\u0275\u0275elementStart(5,"button",13),n.\u0275\u0275listener("click",function(){const o=n.\u0275\u0275restoreView(e).$implicit,d=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(d.addNode(o))}),n.\u0275\u0275element(6,"i",14),n.\u0275\u0275elementEnd()()}if(2&t){const e=i.$implicit,r=n.\u0275\u0275nextContext();n.\u0275\u0275advance(1),n.\u0275\u0275attribute("aria-label","Toggle "+e.name),n.\u0275\u0275advance(1),n.\u0275\u0275classProp("ti-angle-down",r.expandedElement!==r.element)("ti-angle-right",r.expandedElement===r.element),n.\u0275\u0275advance(1),n.\u0275\u0275classProp("ti-file","file"===e.type)("ti-folder","file"!==e.type),n.\u0275\u0275attribute("aria-label",e.type+"icon"),n.\u0275\u0275advance(1),n.\u0275\u0275textInterpolate1(" ",e.name," ")}}let Ne=(()=>{class t{constructor(e,r){this.dataSourceService=e,this.dsHelperService=r,this.editNodeChange=new n.EventEmitter,this.addNodeChange=new n.EventEmitter,this.activeNode=null,this.transformer=(s,o)=>{const d={...s.id&&{id:s.id},name:s.name,type:s.type,level:o,expandable:!!s.children};return this.dsHelperService.flatNodeMap.set(d,s),d},this.treeFlattener=new ve(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new ce(this.getLevel,this.isExpandable),this.dataSource=new Te(this.treeControl,this.treeFlattener),this.dsHelperService.treeFlattener=this.treeFlattener,this.dsHelperService.treeControl=this.treeControl}ngOnInit(){this.initializeData(),this.handleExpandedNodes()}editNode(e){this.editNodeChange.emit(e)}initializeData(){this.dataSourceService.addManyToCache(De),this.dataSources$=this.dataSourceService.entities$,this.dataSources$.subscribe(e=>{this.dataSource.data=e,this.dsHelperService.restoreExpandedNodes(this.treeControl)})}getLevel(e){return e.level}isExpandable(e){return e.expandable}hasChild(e,r){return r.expandable}getChildren(e){return e.children}handleExpandedNodes(){this.treeControl.expansionModel.changed.subscribe(e=>{e.added[0]&&e.added.length?this.dsHelperService.toggleExpandedNodes(this.treeControl,e.added[0]):e.removed.length&&e.removed.forEach(r=>{this.dsHelperService.toggleExpandedNodes(this.treeControl,r,!0)})})}deleteNode(e){const r=this.dsHelperService.getParent(e),s=this.dsHelperService.flatNodeMap.get(r);this.dataSourceService.getOne(s.id).subscribe(o=>{const d=O(o,{name:e.name});this.dataSourceService.updateOne(d)})}addNode(e){this.addNodeChange.emit(e)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(A),n.\u0275\u0275directiveInject(m))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["lib-data-source-list"]],outputs:{editNodeChange:"editNodeChange",addNodeChange:"addNodeChange"},decls:3,vars:3,consts:[[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",4,"matTreeNodeDef"],["matTreeNodePadding","",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding",""],["mat-icon-button","","disabled",""],[1,"type-icon"],["mat-icon-button","","color","accent",1,"icon-btn","edit",3,"click"],[1,"ti-pencil"],["mat-icon-button","","color","warn",1,"icon-btn","delete",3,"click"],[1,"ti-trash"],["matTreeNodePadding",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["mat-icon-button","","color","accent",3,"click"],[1,"ti-plus"]],template:function(e,r){1&e&&(n.\u0275\u0275elementStart(0,"mat-tree",0),n.\u0275\u0275template(1,Ce,8,6,"mat-tree-node",1),n.\u0275\u0275template(2,Ee,7,11,"mat-tree-node",2),n.\u0275\u0275elementEnd()),2&e&&(n.\u0275\u0275property("dataSource",r.dataSource)("treeControl",r.treeControl),n.\u0275\u0275advance(2),n.\u0275\u0275property("matTreeNodeDefWhen",r.hasChild))},dependencies:[ee,te,re,ne,q,ie.Hw,z.RK],styles:[".type-icon[_ngcontent-%COMP%]{color:#757575;margin-right:5px}.icon-btn[_ngcontent-%COMP%]{margin-left:10px}.edit[_ngcontent-%COMP%]     .mat-icon, .delete[_ngcontent-%COMP%]     .mat-icon{font-size:18px}.ti-folder[_ngcontent-%COMP%]{margin-top:8px}"]}),t})();var Se=l(3144);let se=(()=>{class t extends S.EJ{constructor(e,r){super("DataSource",e,r)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(Se.eN),n.\u0275\u0275inject(S.hR))},t.\u0275prov=n.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();const Me={DataSource:{selectId(t){if(null!==t)return t.id||t.name?`${t.id||t.name}`:t._id},entityDispatcherOptions:{optimisticUpdate:!0}}};let be=(()=>{class t{constructor(e,r,s){this.eds=e,this.entityDataService=r,this.dataSourceService=s,this.eds.registerMetadataMap(Me),this.entityDataService.registerService("DataSource",this.dataSourceService)}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275inject(S.f0),n.\u0275\u0275inject(S.sP),n.\u0275\u0275inject(se))},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({providers:[se,A,m],imports:[ye,ie.Ps,z.ot]}),t})();const Oe=[{path:"",component:(()=>{class t{constructor(e,r){this.dataSourceService=e,this.dsHelperService=r}ngOnInit(){}addOne(){this.dataSourceService.addOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}addMany(){this.dataSourceService.addMany([{id:"TESTIDMANY",name:"Test add many",type:"folder",children:[{name:"src many",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsIDMANY",name:"components many 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}upsertOne(){this.dataSourceService.upsertOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}removeOne(){this.dataSourceService.removeOne("TESTID")}removeMany(){this.dataSourceService.removeMany(["TESTID","componentsID"])}updateOne(){this.dataSourceService.updateOne({id:"TESTID",name:"Test 1",type:"folder",children:[{name:"src 1",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]})}updateMany(){this.dataSourceService.updateMany([{id:"TESTID",name:"Test 2",type:"folder",children:[{name:"src 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"componentsID",name:"components 2",type:"folder",children:[{name:"components 2",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]}])}getOne(){this.dataSourceService.getOne("TESTID").subscribe(console.log)}patchOne(){this.dataSourceService.patchOne({id:"TESTID",name:"Test",type:"folder",children:[{name:"src",type:"folder",children:[{name:"cdk",type:"folder",children:[{name:"package.json",type:"file"},{name:"BUILD.bazel",type:"file"}]},{name:"material",type:"folder"}]}]},{id:"TESTIDWOrker",name:"Worker",type:"folder",children:[{id:"TESTIDWOrker2",name:"Worker 2",type:"file"}]})}getFlattenNodes(){console.log("HERREE ",this.dsHelperService.treeFlattener),console.log("Flatten nodes with treeControl ",this.dsHelperService.treeControl.dataNodes),this.dataSourceService.getAll().subscribe(e=>{console.log("Node matrix ",e),console.log("Flatten Nodes ",this.dsHelperService.treeFlattener.flattenNodes(e))})}onNodeEdit(e){const r=this.dsHelperService.flatNodeMap.get(e);this.dsHelperService.updateNode(e,{...r,name:r.name+" UPDATED!"})}onNodeAdd(e){this.dsHelperService.flatNodeMap.get(e),this.dsHelperService.addNode(e,{id:"addNodeID",name:"My New node",type:"file"})}}return t.\u0275fac=function(e){return new(e||t)(n.\u0275\u0275directiveInject(A),n.\u0275\u0275directiveInject(m))},t.\u0275cmp=n.\u0275\u0275defineComponent({type:t,selectors:[["app-tree"]],decls:27,vars:0,consts:[[1,"container"],[1,"col"],[3,"editNodeChange","addNodeChange"],[1,"col","action"],["mat-button","","mat-raised-button","","color","primary",3,"click"]],template:function(e,r){1&e&&(n.\u0275\u0275elementStart(0,"header")(1,"h1"),n.\u0275\u0275text(2,"Tree Demo"),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(3,"div",0)(4,"div",1)(5,"lib-data-source-list",2),n.\u0275\u0275listener("editNodeChange",function(o){return r.onNodeEdit(o)})("addNodeChange",function(o){return r.onNodeAdd(o)}),n.\u0275\u0275elementEnd()(),n.\u0275\u0275elementStart(6,"div",3)(7,"button",4),n.\u0275\u0275listener("click",function(){return r.addOne()}),n.\u0275\u0275text(8," Add DS "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(9,"button",4),n.\u0275\u0275listener("click",function(){return r.addMany()}),n.\u0275\u0275text(10," Add Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(11,"button",4),n.\u0275\u0275listener("click",function(){return r.upsertOne()}),n.\u0275\u0275text(12," Upsert One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(13,"button",4),n.\u0275\u0275listener("click",function(){return r.removeOne()}),n.\u0275\u0275text(14," Remove One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(15,"button",4),n.\u0275\u0275listener("click",function(){return r.removeMany()}),n.\u0275\u0275text(16," Remove Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(17,"button",4),n.\u0275\u0275listener("click",function(){return r.updateOne()}),n.\u0275\u0275text(18," Update One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(19,"button",4),n.\u0275\u0275listener("click",function(){return r.updateMany()}),n.\u0275\u0275text(20," Update Many "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(21,"button",4),n.\u0275\u0275listener("click",function(){return r.getOne()}),n.\u0275\u0275text(22," Get One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(23,"button",4),n.\u0275\u0275listener("click",function(){return r.patchOne()}),n.\u0275\u0275text(24," Patch One "),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(25,"button",4),n.\u0275\u0275listener("click",function(){return r.getFlattenNodes()}),n.\u0275\u0275text(26," Get Flatten Nodes "),n.\u0275\u0275elementEnd()()())},dependencies:[z.lW,Ne],styles:["header[_ngcontent-%COMP%]{margin:20px}.container[_ngcontent-%COMP%]{grid-gap:20px;margin:20px;display:grid;grid-template-columns:3fr 1fr}.action[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:4px}"]}),t})()}];let xe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({imports:[F.Bz.forChild(Oe),F.Bz]}),t})(),Ae=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=n.\u0275\u0275defineInjector({imports:[B.ez,xe,z.ot,be]}),t})()},4128:(J,P,l)=>{l.d(P,{D:()=>_});var B=l(9751),F=l(4742),n=l(8421),S=l(3269),k=l(5403),I=l(3268),A=l(1810);function _(...M){const E=(0,S.jO)(M),{args:R,keys:L}=(0,F.D)(M),j=new B.y(O=>{const{length:p}=R;if(!p)return void O.complete();const a=new Array(p);let c=p,h=p;for(let g=0;g<p;g++){let f=!1;(0,n.Xf)(R[g]).subscribe((0,k.x)(O,m=>{f||(f=!0,h--),a[g]=m},()=>c--,void 0,()=>{(!c||!f)&&(h||O.next(L?(0,A.n)(L,a):a),O.complete())}))}});return E?j.pipe((0,I.Z)(E)):j}},418:(J,P,l)=>{l.d(P,{A8:()=>j,Ov:()=>R,P3:()=>_,Z9:()=>A,eX:()=>E,k:()=>O,o2:()=>I,yy:()=>M});var B=l(4033),F=l(5191),n=l(9646),S=l(7579),k=l(2223);class I{}function A(p){return p&&"function"==typeof p.connect&&!(p instanceof B.c)}class _ extends I{constructor(a){super(),this._data=a}connect(){return(0,F.b)(this._data)?this._data:(0,n.of)(this._data)}disconnect(){}}class M{applyChanges(a,c,h,g,f){a.forEachOperation((m,N,v)=>{let y,C;if(null==m.previousIndex){const w=h(m,N,v);y=c.createEmbeddedView(w.templateRef,w.context,w.index),C=1}else null==v?(c.remove(N),C=3):(y=c.get(N),c.move(y,v),C=2);f&&f({context:y?.context,operation:C,record:m})})}detach(){}}class E{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(a,c,h,g,f){a.forEachOperation((m,N,v)=>{let y,C;null==m.previousIndex?(y=this._insertView(()=>h(m,N,v),v,c,g(m)),C=y?1:0):null==v?(this._detachAndCacheView(N,c),C=3):(y=this._moveView(N,v,c,g(m)),C=2),f&&f({context:y?.context,operation:C,record:m})})}detach(){for(const a of this._viewCache)a.destroy();this._viewCache=[]}_insertView(a,c,h,g){const f=this._insertViewFromCache(c,h);if(f)return void(f.context.$implicit=g);const m=a();return h.createEmbeddedView(m.templateRef,m.context,m.index)}_detachAndCacheView(a,c){const h=c.detach(a);this._maybeCacheView(h,c)}_moveView(a,c,h,g){const f=h.get(a);return h.move(f,c),f.context.$implicit=g,f}_maybeCacheView(a,c){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(a);else{const h=c.indexOf(a);-1===h?a.destroy():c.remove(h)}}_insertViewFromCache(a,c){const h=this._viewCache.pop();return h&&c.insert(h,a),h||null}}class R{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(a=!1,c,h=!0,g){this._multiple=a,this._emitChanges=h,this.compareWith=g,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new S.x,c&&c.length&&(a?c.forEach(f=>this._markSelected(f)):this._markSelected(c[0]),this._selectedToEmit.length=0)}select(...a){this._verifyValueAssignment(a),a.forEach(h=>this._markSelected(h));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}deselect(...a){this._verifyValueAssignment(a),a.forEach(h=>this._unmarkSelected(h));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}setSelection(...a){this._verifyValueAssignment(a);const c=this.selected,h=new Set(a);a.forEach(f=>this._markSelected(f)),c.filter(f=>!h.has(f)).forEach(f=>this._unmarkSelected(f));const g=this._hasQueuedChanges();return this._emitChangeEvent(),g}toggle(a){return this.isSelected(a)?this.deselect(a):this.select(a)}clear(a=!0){this._unmarkAll();const c=this._hasQueuedChanges();return a&&this._emitChangeEvent(),c}isSelected(a){return this._selection.has(this._getConcreteValue(a))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(a){this._multiple&&this.selected&&this._selected.sort(a)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(a){a=this._getConcreteValue(a),this.isSelected(a)||(this._multiple||this._unmarkAll(),this.isSelected(a)||this._selection.add(a),this._emitChanges&&this._selectedToEmit.push(a))}_unmarkSelected(a){a=this._getConcreteValue(a),this.isSelected(a)&&(this._selection.delete(a),this._emitChanges&&this._deselectedToEmit.push(a))}_unmarkAll(){this.isEmpty()||this._selection.forEach(a=>this._unmarkSelected(a))}_verifyValueAssignment(a){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(a){if(this.compareWith){for(let c of this._selection)if(this.compareWith(a,c))return c;return a}return a}}let j=(()=>{class p{constructor(){this._listeners=[]}notify(c,h){for(let g of this._listeners)g(c,h)}listen(c){return this._listeners.push(c),()=>{this._listeners=this._listeners.filter(h=>c!==h)}}ngOnDestroy(){this._listeners=[]}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275prov=k.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();const O=new k.InjectionToken("_ViewRepeater")}}]);